@using System.Web.Script.Serialization
@model ProjectZ.Web.ViewModels.IssueViewModel

@{
    ViewBag.Title = "List";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="jumbo">
    <img src="/Content/images/dexter.jpg" class="header-image">
</div>

<div class="wrapper">
    <nav class="nav">
        <ul>
            <li><a href="@Url.Action("Details","Project")">Overview</a></li>
            <li><a href="@Url.Action("Index","Release")">Releases</a></li>
            <li><a href="#">Polls</a></li>
            <li class="active"><a href="@Url.Action("Index", "Issue")">Issues @Html.Raw(Model.Project.Issues.Any() ? string.Format("<span class='badge'>{0}</span>",Model.Project.Issues.Count) : "")</a></li>
        </ul>
    </nav>
    <div class="inner">
        <div class="content">
            <h1>Issues</h1>

            <ul class="unstyled" data-bind="foreach: issues">
                    <li>
                        <div class="issues">
                            <div class="votes">
                                <h3 class="count" data-bind="text: votes().length"></h3>
                                <p class="vote" data-bind="click: upVote">
                                    <i class="fa fa-thumbs-o-up"></i>
                                </p>

                            </div>
                            <div class="issue">
                                <h3 class="title"><a href="#" data-bind="text: title, attr: {href: '/issue/details/' + id}"></a></h3>
                                <p class="description" data-bind="text: description"></p>
                            </div>
                        </div>
                    </li>
            </ul>

            <!-- please do not remove this line -->

            <div style="display: none;">
                <a href="http://slipsum.com">lorem ipsum</a>
            </div>

            <!-- end slipsum code -->

        </div>
        <div class="sidebar">
            <h1>New issue</h1>
            <div class="box">
                <input type="text" placeholder="Name" />
            </div>
        </div>
    </div>
</div>

@section scripts
{
<script src="~/Scripts/issues.js"></script>
    <script type="text/javascript">
        $(function () {
            var config = {
                data: @Html.Raw(new JavaScriptSerializer().Serialize(Model.Project.Issues)),
                userId: '@Model.UserId'
            };

            var issuesModel1 = new issuesModel.init(config);
            ko.applyBindings(issuesModel1);
        });

    </script>
}
